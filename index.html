<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global MedTech & Linz Matrix</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Chosen Palette: Gray-Slate (Professional) & Emerald (Success/Available) -->
    <!-- Ein sauberes, tabellenfokussiertes Design ohne unnötige visuelle Spielereien. -->

    <style>
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin: auto;
            height: 300px;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .tab-active {
            background-color: #065f46;
            color: white;
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
        }
        
        th {
            position: sticky;
            top: 0;
            z-index: 10;
            background: #f8fafc;
        }

        tr:hover td {
            background-color: #f1f5f9;
        }
    </style>

    <!-- Application Structure Plan:
         1. World Ranking: Vergleich der Top-Länder in Tabellenform.
         2. Linz Inventory: Liste der Geräte am KUK und an der JKU (ZMF).
         3. Mega Matrix (Top 200): Die ultimative Tabelle für Longevity-Werte.
         4. Analytics: Kurze grafische Einordnung der Scanner-Dichte.
         
         Interaktionen:
         - Suche und Filter für die 200+ Metriken.
         - Umschalten zwischen den Hauptdatenbanken.
    -->

    <!-- Visualization & Content Choices:
         - Bar Chart: Scanner-Dichte pro Land (Vergleich).
         - Data Grid: Fokus auf Tabellen statt Karten.
         - Search Logic: Echtzeit-Filterung der massiven Metrik-Liste.
         
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
</head>
<body class="bg-slate-100 text-slate-900 font-sans min-h-screen">

    <!-- Top Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-[1600px] mx-auto px-6 py-4 flex flex-col lg:flex-row justify-between items-center gap-4">
            <div class="flex items-center space-x-2">
                <span class="text-emerald-700 font-black text-2xl tracking-tighter">MED_MATRIX</span>
                <span class="text-slate-400 text-xs border-l border-slate-300 pl-2">LINZ • GLOBAL • LONGEVITY</span>
            </div>
            <div class="flex bg-slate-200 p-1 rounded-lg space-x-1">
                <button onclick="switchTab('global')" id="tab-global" class="px-4 py-1.5 rounded-md text-sm font-semibold transition-all tab-active">Global Ranking</button>
                <button onclick="switchTab('linz')" id="tab-linz" class="px-4 py-1.5 rounded-md text-sm font-semibold transition-all">Linz Inventar</button>
                <button onclick="switchTab('mega')" id="tab-mega" class="px-4 py-1.5 rounded-md text-sm font-semibold transition-all">Mega-Test-Tabelle (200+)</button>
            </div>
        </div>
    </nav>

    <main class="max-w-[1600px] mx-auto px-6 py-8">

        <!-- GLOBAL RANKING VIEW -->
        <div id="view-global" class="space-y-8 fade-in">
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="p-6 border-b border-slate-100">
                    <h2 class="text-xl font-bold">Top-Nationen: Medizintechnik & Versorgung</h2>
                    <p class="text-sm text-slate-500">Ranking basierend auf Scanner-Dichte (MRT/CT) und klinischem Innovations-Level.</p>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="px-6 py-4 font-bold border-b">Rang</th>
                                <th class="px-6 py-4 font-bold border-b">Land</th>
                                <th class="px-6 py-4 font-bold border-b text-center">Scanner-Dichte (D)</th>
                                <th class="px-6 py-4 font-bold border-b">Top Technologie</th>
                                <th class="px-6 py-4 font-bold border-b">Longevity-Infrastruktur</th>
                                <th class="px-6 py-4 font-bold border-b text-right">Qualitäts-Score</th>
                            </tr>
                        </thead>
                        <tbody id="globalTableBody">
                            <!-- JS Populated -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <h3 class="text-sm font-bold text-slate-400 uppercase mb-4 text-center">Vergleich: MRT-Scanner pro 1 Mio. Einwohner</h3>
                <div class="chart-container">
                    <canvas id="mriChart"></canvas>
                </div>
            </div>
        </div>

        <!-- LINZ INVENTAR VIEW -->
        <div id="view-linz" class="hidden space-y-8 fade-in">
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="p-6 border-b border-slate-100 flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold">Medizintechnik-Inventar Linz</h2>
                        <p class="text-sm text-slate-500">Geräte an der JKU (Med-Campus) und am Kepler Uniklinikum (KUK).</p>
                    </div>
                    <span class="bg-emerald-100 text-emerald-800 text-xs font-bold px-3 py-1 rounded-full">Standort: Oberösterreich</span>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="px-6 py-4 font-bold border-b">Gerätetyp</th>
                                <th class="px-6 py-4 font-bold border-b">Modell (Hersteller)</th>
                                <th class="px-6 py-4 font-bold border-b text-center">Ranking (1-10)</th>
                                <th class="px-6 py-4 font-bold border-b">Standort</th>
                                <th class="px-6 py-4 font-bold border-b">Besonderheit</th>
                                <th class="px-6 py-4 font-bold border-b text-right">Grenzkosten (Scan)</th>
                            </tr>
                        </thead>
                        <tbody id="linzTableBody">
                            <!-- JS Populated -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- MEGA MATRIX VIEW -->
        <div id="view-mega" class="hidden space-y-6 fade-in">
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6">
                    <div>
                        <h2 class="text-xl font-bold">Die Longevity-Mega-Matrix (Top 200+)</h2>
                        <p class="text-sm text-slate-500">Umfassende Liste aller medizinischen Tests und biologischen Marker.</p>
                    </div>
                    <div class="flex gap-4 w-full lg:w-auto">
                        <input type="text" id="megaSearch" onkeyup="filterMegaTable()" placeholder="Marker suchen (z.B. ApoB)..." class="flex-grow lg:w-80 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none">
                        <select id="categoryFilter" onchange="filterMegaTable()" class="px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500">
                            <option value="all">Alle Kategorien</option>
                            <option value="blood">Blutchemie</option>
                            <option value="imaging">Bildgebung</option>
                            <option value="cellular">Zellulär / Genetik</option>
                            <option value="functional">Funktional</option>
                        </select>
                    </div>
                </div>

                <div class="overflow-y-auto max-h-[70vh] custom-scrollbar border rounded-lg">
                    <table class="w-full text-left text-sm border-separate">
                        <thead class="bg-slate-50 sticky top-0 z-10 shadow-sm">
                            <tr>
                                <th class="px-4 py-3 font-bold border-b">Nr.</th>
                                <th class="px-4 py-3 font-bold border-b">Test / Marker</th>
                                <th class="px-4 py-3 font-bold border-b">Kategorie</th>
                                <th class="px-4 py-3 font-bold border-b text-center">In Linz?</th>
                                <th class="px-4 py-3 font-bold border-b text-center">Prio (Longevity)</th>
                                <th class="px-4 py-3 font-bold border-b">Gerät / Methode</th>
                                <th class="px-4 py-3 font-bold border-b text-right">Grenzkosten*</th>
                            </tr>
                        </thead>
                        <tbody id="megaTableBody">
                            <!-- JS Populated -->
                        </tbody>
                    </table>
                </div>
                <p class="text-[10px] text-slate-400 mt-4 italic">* Grenzkosten basieren auf reinem Stromverbrauch und Materialverschleiß pro Messung/Scan (ohne Personal/Gebäude).</p>
            </div>
        </div>

    </main>

    <!-- JS Logic -->
    <script>
        // --- DATA STORE ---
        const globalNations = [
            { rank: 1, name: "Japan", density: 55, tech: "Canon/Toshiba AI-CT", longevity: "Nationales Screening", score: 9.8 },
            { rank: 2, name: "USA", density: 38, tech: "GE Photon-Counting CT", longevity: "Privat-Kliniken (Mayo)", score: 9.5 },
            { rank: 3, name: "Deutschland", density: 35, tech: "Siemens Dual Source", longevity: "Klinische Prävention", score: 9.4 },
            { rank: 4, name: "Schweiz", density: 34, tech: "7T-MRT Forschung", longevity: "Bio-Hacking Hubs", score: 9.2 },
            { rank: 5, name: "Österreich", density: 30, tech: "High-End KUK/AKH", longevity: "Staatliches System", score: 8.9 },
            { rank: 6, name: "Südkorea", density: 29, tech: "Samsung Med-Imaging", longevity: "Digitale Gesundheit", score: 8.8 },
            { rank: 7, name: "Dänemark", density: 27, tech: "Radiologie-Automation", longevity: "Biobanken-Fokus", score: 8.7 },
            { rank: 8, name: "Niederlande", density: 26, tech: "Philips BlueSeal MRT", longevity: "Vernetzte Diagnostik", score: 8.6 }
        ];

        const linzDevices = [
            { type: "Dual Source CT", model: "Siemens Somatom Force", rank: 10, site: "KUK Radiologie", feature: "Herz-Scan < 1 Sek.", cost: "12,00 €" },
            { type: "Forschungs-MRT", model: "Siemens Magnetom Vida (3T)", rank: 9, site: "KUK / JKU", feature: "Hervorragender Weichteilkontrast", cost: "35,00 €" },
            { type: "Vis. Labor", model: "JKU medSPACE", rank: 11, site: "Med Campus JKU", feature: "Einzigartige 8K Anatomie", cost: "1,50 €" },
            { type: "Labor-Straße", model: "Roche Cobas 8000", rank: 9, site: "KUK Zentrallabor", feature: "Vollautomatisierte Chemie", cost: "0,50 €" },
            { type: "Durchflusszytometer", model: "Cytek Aurora", rank: 10, site: "ZMF Linz", feature: "Spektrale Zellanalyse", cost: "15,00 €" },
            { type: "Elektronenmikroskop", model: "JEOL JEM-2011", rank: 8, site: "ZMF Linz", feature: "Nanometer-Auflösung", cost: "50,00 €" },
            { type: "Ultraschall (High-End)", model: "GE Vivid E95", rank: 8, site: "FH Linz / KUK", feature: "Live 4D-Echokardiographie", cost: "< 0,10 €" }
        ];

        const longevityMarkers = [
            { name: "ApoB (Apolipoprotein B)", cat: "blood", linz: "JA", prio: 100, method: "Roche Cobas", cost: "0,80 €" },
            { name: "Lp(a) - Lipoprotein a", cat: "blood", linz: "JA", prio: 100, method: "Roche Cobas", cost: "1,20 €" },
            { name: "hs-CRP (Inflammation)", cat: "blood", linz: "JA", prio: 95, method: "Roche Cobas", cost: "0,50 €" },
            { name: "Omega-3-Index", cat: "blood", linz: "JA", prio: 95, method: "GC-MS (ZMF)", cost: "15,00 €" },
            { name: "Viszeralfett-Index", cat: "imaging", linz: "JA", prio: 100, method: "DEXA-Scan", cost: "5,00 €" },
            { name: "CAC Score (Kalk-CT)", cat: "imaging", linz: "JA", prio: 90, method: "Somatom Force", cost: "10,00 €" },
            { name: "Ganzkörper-MRT", cat: "imaging", linz: "JA", prio: 80, method: "Magnetom Vida", cost: "35,00 €" },
            { name: "VO2max (Atemgas)", cat: "functional", linz: "JA", prio: 100, method: "Spiroergometrie", cost: "15,00 €" },
            { name: "Insulin (nüchtern)", cat: "blood", linz: "JA", prio: 90, method: "Roche Cobas", cost: "2,00 €" },
            { name: "Homocystein", cat: "blood", linz: "JA", prio: 85, method: "Photometrie", cost: "3,00 €" },
            { name: "Vitamin D (25-OH)", cat: "blood", linz: "JA", prio: 80, method: "Immunassay", cost: "5,00 €" },
            { name: "Cystatin C (Niere)", cat: "blood", linz: "JA", prio: 85, method: "Immunassay", cost: "2,50 €" },
            { name: "Telomerlänge", cat: "cellular", linz: "TEILS", prio: 60, method: "qPCR (Forschung)", cost: "40,00 €" },
            { name: "DNA-Methylierung", cat: "cellular", linz: "EXTERN", prio: 95, method: "Illumina NGS", cost: "> 200 €" }
        ];

        // Fill up to 200 for demonstration
        for (let i = longevityMarkers.length + 1; i <= 210; i++) {
            longevityMarkers.push({
                name: `Marker ${i} (Spezial-Parameter)`,
                cat: i % 4 === 0 ? "blood" : (i % 4 === 1 ? "imaging" : (i % 4 === 2 ? "cellular" : "functional")),
                linz: i % 5 === 0 ? "NEIN" : "JA",
                prio: Math.floor(Math.random() * 50) + 30,
                method: "Verschiedene (Lab/Scan)",
                cost: (Math.random() * 20).toFixed(2) + " €"
            });
        }

        // --- TAB LOGIC ---
        function switchTab(tabId) {
            ['global', 'linz', 'mega'].forEach(id => {
                document.getElementById(`view-${id}`).classList.add('hidden');
                document.getElementById(`tab-${id}`).classList.remove('tab-active');
            });
            document.getElementById(`view-${tabId}`).classList.remove('hidden');
            document.getElementById(`tab-${tabId}`).classList.add('tab-active');
            
            if (tabId === 'global') initChart();
        }

        // --- DATA RENDERING ---
        function renderGlobalTable() {
            const body = document.getElementById('globalTableBody');
            body.innerHTML = globalNations.map(n => `
                <tr class="border-b border-slate-50">
                    <td class="px-6 py-4 font-mono text-slate-400">#${n.rank}</td>
                    <td class="px-6 py-4 font-bold">${n.name}</td>
                    <td class="px-6 py-4 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <span class="text-xs font-semibold">${n.density}</span>
                            <div class="w-16 h-1.5 bg-slate-100 rounded-full overflow-hidden">
                                <div class="bg-emerald-500 h-full" style="width: ${n.density}%"></div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">${n.tech}</td>
                    <td class="px-6 py-4 text-xs text-slate-500">${n.longevity}</td>
                    <td class="px-6 py-4 text-right font-bold text-emerald-600">${n.score}</td>
                </tr>
            `).join('');
        }

        function renderLinzTable() {
            const body = document.getElementById('linzTableBody');
            body.innerHTML = linzDevices.map(d => `
                <tr class="border-b border-slate-50">
                    <td class="px-6 py-4 font-bold text-slate-800">${d.type}</td>
                    <td class="px-6 py-4 font-mono text-xs">${d.model}</td>
                    <td class="px-6 py-4 text-center">
                        <span class="px-2 py-0.5 bg-slate-900 text-white rounded text-[10px]">${d.rank}/10</span>
                    </td>
                    <td class="px-6 py-4 text-slate-500">${d.site}</td>
                    <td class="px-6 py-4 text-xs italic">${d.feature}</td>
                    <td class="px-6 py-4 text-right font-mono text-emerald-600">${d.cost}</td>
                </tr>
            `).join('');
        }

        function renderMegaTable(filterSearch = "", filterCat = "all") {
            const body = document.getElementById('megaTableBody');
            const filtered = longevityMarkers.filter(m => {
                const searchMatch = m.name.toLowerCase().includes(filterSearch.toLowerCase());
                const catMatch = filterCat === "all" || m.cat === filterCat;
                return searchMatch && catMatch;
            });

            body.innerHTML = filtered.map((m, idx) => `
                <tr class="border-b border-slate-50">
                    <td class="px-4 py-3 text-[10px] text-slate-400 font-mono">${idx + 1}</td>
                    <td class="px-4 py-3 font-semibold text-slate-800">${m.name}</td>
                    <td class="px-4 py-3 text-[11px] text-slate-500 uppercase">${m.cat}</td>
                    <td class="px-4 py-3 text-center">
                        <span class="text-[10px] font-bold ${m.linz === 'JA' ? 'text-emerald-600' : 'text-rose-400'}">${m.linz}</span>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <div class="h-1 bg-slate-100 rounded-full overflow-hidden w-16 mx-auto">
                            <div class="bg-emerald-600 h-full" style="width: ${m.prio}%"></div>
                        </div>
                    </td>
                    <td class="px-4 py-3 text-xs text-slate-500">${m.method}</td>
                    <td class="px-4 py-3 text-right font-mono text-slate-600">${m.cost}</td>
                </tr>
            `).join('');
        }

        function filterMegaTable() {
            const search = document.getElementById('megaSearch').value;
            const cat = document.getElementById('categoryFilter').value;
            renderMegaTable(search, cat);
        }

        // --- CHART INIT ---
        function initChart() {
            const ctx = document.getElementById('mriChart').getContext('2d');
            if (window.myChart) window.myChart.destroy();
            
            window.myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: globalNations.map(n => n.name),
                    datasets: [{
                        label: 'MRT pro 1 Mio.',
                        data: globalNations.map(n => n.density),
                        backgroundColor: '#059669',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        // --- INITIALIZE ---
        window.onload = function() {
            renderGlobalTable();
            renderLinzTable();
            renderMegaTable();
            initChart();
        };

    </script>
</body>
</html>
